<table id="tbl">
  <thead>
    <tr><th>UID</th><th>Views</th><th>Last updated</th></tr>
  </thead>
  <tbody></tbody>
</table>

<script>
const UIDS_URL  = 'https://vinhhung1509.github.io/ViewTikWeb/data/uids.json';
const VIEWS_URL = 'https://vinhhung1509.github.io/ViewTikWeb/data/views.json';

let uidList = [];

// Load danh sách UID
async function loadUIDs(){
  try{
    const res = await fetch(UIDS_URL + '?t=' + Date.now());
    uidList = await res.json();
  }catch(e){
    console.error("Không đọc được uids.json:", e);
    uidList = [];
  }
}

// Load dữ liệu views
async function loadViews(){
  try{
    const res = await fetch(VIEWS_URL + '?t=' + Date.now());
    return await res.json();
  }catch(e){
    console.error("Không đọc được views.json:", e);
    return {};
  }
}

// Render bảng
async function render(){
  const data = await loadViews();
  const tbody = document.querySelector('#tbl tbody');
  tbody.innerHTML = '';

  for(const uid of uidList){
    const info = data[uid] || {};
    const row = document.createElement('tr');
    row.innerHTML = `
      <td>${uid}</td>
      <td>${info.views ?? '—'}</td>
      <td>${info.updated ?? '—'}</td>
    `;
    tbody.appendChild(row);
  }
}

// Chạy lần đầu
async function init(){
  await loadUIDs();
  render();
  // Cập nhật mỗi 10s
  setInterval(render, 10000);
}

init();
</script>
